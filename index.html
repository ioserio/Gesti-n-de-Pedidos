<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1280">
    <title>Gestión de Pedidos</title>
    <link rel="stylesheet" href="estilos.css">
</head>
<body>
    <header>
        <nav>
            <a href="index.html" class="brand-logo" aria-label="RikFlex Home">RikFlex</a>
            <ul class="menu">
                <li><a href="#" onclick="mostrarModulo('subir')"><span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 3l4 4h-3v6h-2V7H8l4-4z"/><path d="M4 14h16v5a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-5z"/></svg></span>Importar</a></li>
                <li><a href="#" onclick="mostrarModulo('consultar')"><span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><circle cx="11" cy="11" r="6"/><path d="M20 20l-4.35-4.35" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"/></svg></span>Consultar por Vendedor</a></li>
                <li><a href="#" onclick="mostrarModulo('resumen')"><span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="10" width="4" height="10" rx="1"/><rect x="10" y="6" width="4" height="14" rx="1"/><rect x="17" y="3" width="4" height="17" rx="1"/></svg></span>Resumen de Pedidos</a></li>
                <li><a href="#" onclick="mostrarModulo('cobranzas')"><span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 1a4 4 0 00-4 4v1H6a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V8a2 2 0 00-2-2h-2V5a4 4 0 00-4-4zm-2 5V5a2 2 0 114 0v1h-4z"/></svg></span>Gestión de Cobranzas</a></li>
                <li class="has-submenu">
                    <a href="#" onclick="mostrarModulo('devoluciones')"><span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 5v4H7l5 5 5-5h-5V5z"/><path d="M5 19h14v-2H5v2z"/></svg></span>Gestión de Devoluciones</a>
                    <ul class="submenu">
                        <li><a href="#" onclick="mostrarModulo('devoluciones')">Clasificaciones</a></li>
                        <li><a href="#" onclick="mostrarModulo('recojos')">Consulta de Recojos</a></li>
                    </ul>
                </li>
                <li><a href="#" onclick="mostrarModulo('admin')"><span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19.14 12.94a7.46 7.46 0 000-1.88l2.03-1.58a.5.5 0 00.12-.64l-1.92-3.32a.5.5 0 00-.6-.22l-2.39.96a7.52 7.52 0 00-1.63-.95L14.5 1.9a.5.5 0 00-.49-.4h-3.99a.5.5 0 00-.49.4l-.36 2.41c-.57.23-1.11.54-1.63.95l-2.39-.96a.5.5 0 00-.6.22L2.64 8.35a.5.5 0 00.12.64l2.03 1.58c-.05.31-.08.63-.08.94s.03.63.08.94L2.76 14.03a.5.5 0 00-.12.64l1.92 3.32c.14.24.44.34.7.22l2.39-.96c.51.41 1.06.73 1.63.95l.36 2.41c.06.24.26.4.49.4h3.99c.23 0 .43-.16.49-.4l.36-2.41c.57-.23 1.11-.54 1.63-.95l2.39.96c.26.11.56.01.7-.22l1.92-3.32a.5.5 0 00-.12-.64l-2.03-1.58zM12 15.5A3.5 3.5 0 1112 8a3.5 3.5 0 010 7.5z"/></svg></span>Administrador</a></li>
            </ul>
        </nav>
    </header>
    <div class="container">
    <section id="modulo-subir">
        <h2>Subir archivo Excel de Pedidos</h2>
        <form action="procesar_excel.php" method="post" enctype="multipart/form-data">
            <input type="file" name="archivo_excel" accept=".xlsx,.xls" required>
            <button type="submit">Subir</button>
        </form>
        <div id="preview"></div>

        <hr style="margin:24px 0;">

        <h2>Subir Excel de Devoluciones por Cliente</h2>
        <p>Selecciona tu archivo <b>DEVOLUCIONES POR CLIENTE.xlsx</b> para cargarlo en la tabla <code>devoluciones_por_cliente</code>.</p>
        <form action="procesar_devoluciones.php" method="post" enctype="multipart/form-data" style="margin-top:10px;">
            <input type="file" name="archivo_devoluciones" accept=".xlsx,.xls" required>
            <label style="margin-left:14px;">
                Fecha:
                <input type="date" name="fecha_devoluciones" required>
            </label>
            <label style="margin-left:14px;">
                <input type="checkbox" name="replace_all" value="1" checked>
                Reemplazar registros de esa fecha
            </label>
            <button type="submit" style="margin-left:14px;">Subir Devoluciones</button>
        </form>

        <hr style="margin:24px 0;">

        <h2>Subir Excel de Cobranzas (Cuentas por Cobrar y Pagar)</h2>
        <p>Selecciona tu archivo <b>CUENTAS POR COBRAR Y PAGAR.xlsx</b> para cargarlo en la tabla <code>cuentas_por_cobrar_pagar</code>.</p>
        <form action="procesar_cobranzas.php" method="post" enctype="multipart/form-data" style="margin-top:10px;">
            <input type="file" name="archivo_cobranzas" accept=".xlsx,.xls" required>
            <label style="margin-left:14px; display:inline-flex; align-items:center; gap:6px;">
                <input type="checkbox" name="truncate" value="1">
                Vaciar tabla antes de importar
            </label>
            <button type="submit" style="margin-left:14px;">Subir Cobranzas</button>
        </form>
    </section>
    <section id="modulo-consultar" style="display:none;">
        <h2>Consultar Pedidos por Vendedor</h2>
        <form id="form-consultar">
            <label for="cod_vendedor">Código de Vendedor:</label>
            <input type="text" id="cod_vendedor" name="cod_vendedor" required>
            <button type="submit">Consultar</button>
        </form>
        <div id="resultados"></div>
    </section>
    <section id="modulo-resumen" style="display:none;">
        <h2>Resumen de Pedidos por Vendedor</h2>
    <form id="form-resumen" style="margin-bottom:20px; display:flex; flex-wrap:wrap; align-items:center; gap:10px;">
            <label for="fecha_resumen">Fecha:</label>
            <input type="date" id="fecha_resumen" name="fecha_resumen" value="" required>
            <label for="supervisor_resumen" style="margin-left:15px;"><b>Supervisor:</b></label>
            <select id="supervisor_resumen" name="supervisor_resumen">
                <option value="">Todos</option>
                <option value="JOSE">JOSE</option>
                <option value="CARLOS">CARLOS</option>
                <option value="JESUS">JESUS</option>
                <option value="FRANCISCO">FRANCISCO</option>
                <option value="OFICINA">OFICINA</option>
            </select>
            <button type="submit">Consultar</button>
            <span id="ultima_actualizacion" style="margin-left:auto; color:#555; font-weight:600; white-space:nowrap;"></span>
        </form>
        <div id="resumen"></div>
    </section>
    <section id="modulo-cobranzas" style="display:none;">
        <h2>Gestión de Cobranzas</h2>
        <form id="form-cobranzas" style="margin-bottom:15px; display:flex; flex-wrap:wrap; gap:10px; align-items:center;">
            <label for="vd_cobranza">Vendedor:</label>
            <input type="text" id="vd_cobranza" name="cod_vendedor" placeholder="Ej: 021" style="width:90px;">
            <button type="submit">Consultar</button>
        </form>
        <div id="cobranzas"></div>
    </section>
    <section id="modulo-admin" style="display:none;">
        <h2>Administrador de Cuotas</h2>
        <form id="form-cuota" style="margin-bottom:15px;">
            <label for="cuota_vd">Cod Vendedor:</label>
            <input type="text" id="cuota_vd" name="cod_vendedor" placeholder="Ej: 021" required style="width:90px;">
            <label for="cuota_dia" style="margin-left:10px;">Día:</label>
            <select id="cuota_dia" name="dia_semana">
                <option value="1">Lunes</option>
                <option value="2">Martes</option>
                <option value="3">Miércoles</option>
                <option value="4">Jueves</option>
                <option value="5">Viernes</option>
                <option value="6">Sábado</option>
                <option value="7">Domingo</option>
            </select>
            <label for="cuota_monto" style="margin-left:10px;">Cuota S/</label>
            <input type="number" id="cuota_monto" name="cuota" step="0.01" min="0" required style="width:120px;">
            <button type="submit">Guardar Cuota</button>
        </form>
        <div id="lista-cuotas"></div>
    </section>
    <section id="modulo-devoluciones" style="display:none;">
        <h2>Gestión de Devoluciones</h2>
        <form id="form-devoluciones" style="margin-bottom:15px;">
            <label for="fecha_dev">Fecha:</label>
            <input type="date" id="fecha_dev" name="fecha" required>
            <label for="dev_cod_vend" style="margin-left:10px;">Vendedor:</label>
            <input type="text" id="dev_cod_vend" name="cod_vendedor" placeholder="Ej: 021" style="width:90px;">
            <label for="dev_cod_cli" style="margin-left:10px;">Cliente:</label>
            <input type="text" id="dev_cod_cli" name="cod_cliente" placeholder="Código" style="width:120px;">
            <label for="dev_veh" style="margin-left:10px;">Vehículo:</label>
            <select id="dev_veh" name="vehiculo" style="min-width:180px;">
                <option value="">Todos (cargar lista)</option>
            </select>
            <button type="submit" style="margin-left:10px;">Consultar</button>
        </form>
        <div id="devoluciones"></div>
    </section>
    <section id="modulo-recojos" style="display:none;">
        <h2>Consulta de Recojos</h2>
        <form id="form-recojos" style="margin-bottom:15px; display:flex; flex-wrap:wrap; gap:10px; align-items:center;">
            <label for="fecha_recojo_desde">Desde:</label>
            <input type="date" id="fecha_recojo_desde" name="fecha_desde">
            <label for="fecha_recojo_hasta" style="margin-left:10px;">Hasta:</label>
            <input type="date" id="fecha_recojo_hasta" name="fecha_hasta">
            <label for="supervisor_recojo" style="margin-left:10px;">Supervisor:</label>
            <select id="supervisor_recojo" name="supervisor" style="width:120px;">
                <option value="">Todos</option>
                <option value="JOSE">JOSE</option>
                <option value="CARLOS">CARLOS</option>
                <option value="JESUS">JESUS</option>
                <option value="FRANCISCO">FRANCISCO</option>
                <option value="OFICINA">OFICINA</option>
            </select>
            <label for="vd_recojo" style="margin-left:10px;">Vendedor:</label>
            <input type="text" id="vd_recojo" name="cod_vendedor" placeholder="Ej: 021" style="width:90px;">
            <label for="cliente_recojo" style="margin-left:10px;">Cliente:</label>
            <input type="text" id="cliente_recojo" name="cliente" placeholder="Código o nombre" style="width:160px;">
            <label style="display:inline-flex; align-items:center; gap:6px; margin-left:10px;">
                <input type="checkbox" id="recojo_pend" name="pendientes" value="1">
                Filtrar pendientes
            </label>
            <button type="submit" style="margin-left:10px;">Consultar</button>
        </form>
        <div id="recojos"></div>
    </section>
    </div>
    <script src="script.js"></script>
</body>
</html>
